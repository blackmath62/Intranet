{% extends 'base.html.twig' %}

{% block title %}Page des Tickets
{% endblock %}

{% block body %}
	<section class="content-header">

		<div class="card collapsed-card card-dark">
			<div class="card-header">
				<h3 class="card-title">Créer un nouveau ticket</h3>

				<div class="card-tools">
					<button type="button" class="btn btn-tool p-2" data-card-widget="collapse">
						<i class="fas fa-plus"></i>
					</button>
				</div>
			</div>
			{{ form_start(formTickets) }}

			<div class="card-body d-flex flex-wrap">
				<div class="form-group col-12">
					{{ form_widget(formTickets.title)}}
				</div>
				<div class="form-group col-12">
					<label>{{ form_label(formTickets.content) }}:</label>
					{{ form_widget(formTickets.content)}}
				</div>
				<div class="form-group col-2">
					<label>{{ form_label(formTickets.service) }}:</label>
					{{ form_widget(formTickets.service) }}
				</div>
				<div class="form-group col-2">
					<label>{{ form_label(formTickets.societe) }}:</label>
					{{ form_widget(formTickets.societe) }}
				</div>
				<div class="form-group col-2">
					<label>{{ form_label(formTickets.priority) }}:</label>
					{{ form_widget(formTickets.priority) }}
				</div>
                <div class="form-group col-3">
					<label>{{ form_label(formTickets.file) }}:</label>
					{{ form_widget(formTickets.file) }}
				</div>
				<div class="d-none">
					<label>{{ form_label(formTickets.statu) }}:</label>
					{{ form_widget(formTickets.statu) }}
				</div>

				<div class="form-group col-3 text-right">
					{{ form_widget(formTickets.poster) }}
				</div>
			</div>
			{{ form_end(formTickets) }}
		</div>
		<!-- Control Sidebar -->
		<aside class="control-sidebar control-sidebar-dark"></aside>
		<!-- /.control-sidebar -->
		<!-- ./wrapper -->

		<!-- /.Création -->
			<div class="card card-secondary"> <div class="card-header">
				<h3 class="card-title">Tickets déposés</h3>
			</div>
			{% for ticket in tickets %}
				<div class="card collapsed-card card-light border m-2">
					<div class="card-header">
						<div class="d-flex ">
							<h2 class="card-title mr-auto p-2">{{ ticket.title}}</h2>
							<div>
								<a class="btn btn-sm" style="background-color: {{ ticket.priority.color }}; color: {{ ticket.priority.textColor }}" ;>{{ ticket.priority.title }}</a>
								<h2 class="card-title p-2">
									{{ ticket.user.pseudo}}
									le
									{{ ticket.createdAt|date("d/m/Y")}}
									à
									{{ ticket.createdAt|date("H:i")}}
								</h2>
							</div>
							<div class="card-tools">
								<button type="button" class="btn btn-tool p-2" data-card-widget="collapse">
									<i class="fas fa-plus"></i>
								</button>
							</div>
						</div>
					</div>

					<div class="card-body">
						<div class="form-group col-12">
							<label for="exampleInputEmail1">Objet</label>
							<h3 type="text" name="objet" id="objet">{{ ticket.title}}</h3>
						</div>
						<div class='d-flex flex-wrap'>
							<div class="form-group col-2">
								<label for="exampleInputPassword1">Date ouverture</label>
								<div>{{ ticket.createdAt|date("d/m/Y")}}</div>
							</div>
							<div class="form-group col-2">
								<label for="exampleInputPassword1">Date clotûre</label>
								{% if  ticket.closedAt  %}
									<div>{{ ticket.closedAt|date("d/m/Y")}}</div>
								{% endif %}
							</div>
							<div class="form-group col-2">
								<label for="exampleInputPassword1">Service</label>
								<div>
									<a class="btn btn-xl" style="background-color: {{ ticket.service.color }}; color: {{ ticket.service.textColor }}" ;>{{ ticket.service.title }}</a>
								</div>
							</div>
							<div class="form-group col-2">
								<label for="exampleInputPassword1">Statut</label>
								<div>
									<a class="btn btn-xl" style="background-color: {{ ticket.statu.backgroundColor }}; color: {{ ticket.statu.textColor }}" ;>{{ ticket.statu.title }}</a>
								</div>
							</div>
							<div class="form-group col-2">
								<img class="img-fluid col-12" src="{{ ticket.societe.img }}">
							</div>
						</div>
						<div class="form-group col-12">
							<label for="exampleInputPassword1">Détail</label>
							<article>{{ ticket.content|raw}}</article>
						</div>

						<div class='row'>
						{% if is_granted('ROLE_ADMIN') %}
						<div class="form-group mx-auto align-center">
							<a href=" {{ path('app_contact') }}" class="btn btn-danger">
								<i class="fas fa-envelope mr-2"></i>
								Envoyer par mail à Progiteam
							</a>
						</div>
						<div class="form-group mx-auto align-center">
							<a href=" {{ path('app_contact') }}" class="btn btn-info">
								<i class="fas fa-envelope mr-2"></i>
								Envoyer par mail à F-18
							</a>
						</div>
						{% endif %}
						<div class="form-group mx-auto align-center">
							<a href=" {{ path('app_contact') }}" class="btn btn-dark">
								<i class="fas fa-comments mr-2"></i>
								Déposer un commentaire
							</a>
						</div>
						</div>

					</div>
				</div>
			{% endfor %}
		</div>
	</section>
	<script>
		tinymce.init({
selector: 'textarea',
height: 500,
menubar: false,
plugins: [
'advlist autolink link lists image charmap print preview anchor textcolor', 'searchreplace visualblocks code fullscreen', 'insertdatetime media table contextmenu paste code help'
],
toolbar: 'insert | undo redo | styleselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | help'
});
	</script>
	<script>
		$(function () {
$('.textarea').summernote()
})
	</script>
{% endblock %}
