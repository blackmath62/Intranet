{% extends 'base.html.twig' %}
{% block title %}
	{{ title }}
{% endblock %}
{% block body %}
<section class="content-header">
<div class="alert alert-info alert-dismissible col-12">
                  <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                  <h5><i class="icon fas fa-info-circle"></i> info</h5>
                  Pour déposer une idée d'amélioration, cliquez sur tickets sur la gauche puis sur la barre à droite de Créer un nouveau ticket. </br>
                  Dans le degrés d'urgence, selectionnez boite à idée. </br>
</div>

{% if is_granted('ROLE_ADMIN') %}
            <!-- ./col -->
        <div href="" class="col-lg-3 col-6 pt-2">
        <!-- small card -->            
            <div class="small-box bg-warning">
            <!-- Loading (remove the following to stop the loading)-->
            <!-- end loading -->
                <div class="inner">
                    <h3>Boite à idée</h3>
                    <p>Toutes les idées sont bonnes à prendre !</p>
                </div>
                <div class="icon d-flex flex-column">
                    <i class="fas fa-lightbulb"></i>
                </div>
                <div class="card card-warning collapsed-card">
                    <div class="card-header">
                        <a data-card-widget="collapse" class="small-box-footer">
                        Plus d'info <i class="fas fa-arrow-circle-right"></i>
                        </a>
                    <!-- /.card-tools -->
                    </div>
                <!-- /.card-header -->
                    <div class="card-body">
                    Déposez vos idées et participez au développement du site Intranet en accord avec vos besoins ....
                    </div>
                <!-- /.card-body -->
                </div>
            </div>
        </div>
          <!-- ./col -->             



    <!-- /.Création -->
    <div class='d-flex flex-wrap'>
        <div class="col-md-5">
            <div class="card">
                <div class="card-header bg-warning">
                        <div class="d-flex">
                            <i class="far fa-lightbulb pr-2"></i>
                            <h3 class="card-title">Déposer une idée !</h3>
                        </div>
                        <div class='text-right'>
                            <h6 class="card-subtitle text-muted">Je veux participer à l'évolution du site intranet !</h6>
                        </div>
                </div>
                <div class="card-body">
                    {{ form_start(ideaBoxForm)}}
                    {{ form_row(ideaBoxForm.sujet)}}
                    {{ form_row(ideaBoxForm.content)}}
                    {{ form_widget(ideaBoxForm.Envoyer)}}
                    {{ form_end(ideaBoxForm)}}
                </div>
            </div>
        </div>



        <div class="col-md-7">
            <div class="card">
                <div class="card-header bg-dark">
                    <h3 class="card-title text-center">Idées Déposées</h3>
                </div>
                <!-- /.card-header -->
                <div class="card-body">
                    <table id="example1" class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                <th class="text-center">
                                    <span>Sujet</span>
                                </th>
                                </th>
                                <th class="text-center">
                                    <span>Action</span>
                                </th>
                            </tr>
                        </thead>
                        <tbody>

                            {% for idea in ideas %}
                                {% if idea.status == false %}
                                    <tr>
                                        <td >
                                            <div>
                                            <u><strong>Titre : </strong> </u>
                                            <a class="text-center text-dark">{{ idea.sujet}}</a>
                                            </div>
                                            <div>
                                            <u><strong>Aperçu : </strong></u>
                                            <a class="text-center text-dark">{{ idea.content|striptags|slice(0, 100)|raw }}.....</a>
                                            </div>
                                            <div class="text-right">
                                            <small>
												
												Déposé par 
												{{ idea.user.pseudo}}
												le
												{{ idea.createdAt|date("d/m/Y")}}
												à
												{{ idea.createdAt|date("H:i")}}
												
											</small>
                                            </div>
                                        </td>
                                    
                                        
                                        <td class="text-center" style="vertical-align: middle;">
                                            <a href="{{ path('app_idea_show', {'id' : idea.id}) }}" type="button" class="btn btn-info">
                                                <i class="far fa-eye"></i></a>
                                            <a href="{{ path('app_idea_edit', {'id' : idea.id}) }}" type="button" class="btn btn-warning">
                                                <i class="fas fa-edit"></i>
                                            </a>
                                        </td>
                                    </tr>
                                {% endif %}
                            {% endfor %}

                        </tbody>
                        <tfoot>
                            <tr>
                                <th class="text-center">
                                    <span>Sujet</span>
                                </th>
                                <th class="text-center">
                                    <span>Action</span>
                                </th>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
            <div class="col-md-12">
                <!-- USERS LIST -->
                <div class="card">
                  <div class="card-header">
                    <h3 class="card-title">Membres</h3>
                    <div class="card-tools">
                      <span class="badge badge-danger">{{ users|length }} Membres</span>
                      <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i>
                      </button>
                      <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-times"></i>
                      </button>
                    </div>
                  </div>
                  <!-- /.card-header -->
                  <div class="card-body p-0">
                    <ul class="users-list clearfix">
                      {% for user in users %}
                      <li>
                        <img src="img/profile/{{ user.img }}" alt="User Image">
                        <a class="users-list-name" href="mailto:{{ user.email }}">{{ user.pseudo }}</a>
                      {% for track in tracks %}
                      {% if track.user_id == user.id %}
                      <span class="users-list-date">Derniére visite : </span>
                        <span class="users-list-date">{{ track.createdAt|date("d/m/Y-H:i")}}</span>
                      {% endif %}
                      {% endfor %}
                      </li>
                      {% endfor %}              
                     
                    </ul>
                  </div>
                </div>
              </div>
        </div>
                
        
    </div>
{% endif %}
</section>
{% endblock %}